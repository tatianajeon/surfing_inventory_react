/**
 * for use in nodejs
 */
if (window === undefined) {
    window = {};
}
if (global === undefined) {
    global = {};
}

/**
 * chech if before inited
 */
if (window.$REACTFIRE || global.$REACTFIRE) {
    /**
     * empty
     */
} else {
    /**
     * init react fire
     */
    const rf = {
        /**
         * braz repository
         */
        braz: {},
        /**
         * init event
         * @param {string} name 
         * @param {function} fire 
         */
        spark(name, fire = () => { }) {
            if (name === undefined) {
                throw 'set name for init spark';
            }
            if (this.braz[name]) {
                /**
                 * empty
                 */
            } else {
                this.braz[name] = {};
            }
            if (this.braz[name].smokes) {
                /**
                 * empty
                 */
            } else {
                this.braz[name].smokes = [];
            }
            this.braz[name].fire = fire;
        },
        /**
         * emit event
         * @param {string} name 
         * @param {object} gasoline 
         */
        fire(name, gasoline = {}) {
            if (name === undefined) {
                throw 'set name for emit fire';
            }
            if (this.braz[name]) {
                this.braz[name].coal = this.braz[name].fire(gasoline);
                this.braz[name].smokes.forEach((smoke) => smoke(this.braz[name].coal));
            }
        },
        /**
         * listen event
         * @param {string} name 
         * @param {function} cough 
         */
        smoke(name, cough) {
            if (name === undefined) {
                throw 'set name for init smoke';
            }
            if (this.braz[name]) {
                this.braz[name].smokes.push(cough);
            }
        },
        /**
         * get last result of event fire
         * @param {string} name 
         */
        coal(name) {
            if (name === undefined) {
                throw 'set name for get coal';
            }
            return this.braz[name].coal;
        }
    };
    /**
     * global decalre
     */
    window.$REACTFIRE = rf;
    global.$REACTFIRE = rf;
}


module.exports = window.$REACTFIRE;